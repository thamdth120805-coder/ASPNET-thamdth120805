@model IEnumerable<OnlineLearningPlatform.Models.Enrollment>
@{
    ViewData["Title"] = "Khóa học của tôi";
}

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 col-lg-2 sidebar bg-light">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Dashboard", "Member")">
                            <i class="fas fa-tachometer-alt"></i> Tổng quan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="@Url.Action("MyCourses", "Member")">
                            <i class="fas fa-book"></i> Khóa học của tôi
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Wishlist", "Member")">
                            <i class="fas fa-heart"></i> Danh sách yêu thích
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Profile", "Member")">
                            <i class="fas fa-user"></i> Thông tin cá nhân
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Khóa học của tôi</h1>
            </div>

            @if (Model.Any())
            {
                <div class="row">
                    @foreach (var enrollment in Model)
                    {
                        <div class="col-md-6 col-lg-4 mb-4">
                            <div class="card h-100">
                                <img src="@(enrollment.Course.ThumbnailUrl ?? "/images/default-course.jpg")" 
                                     class="card-img-top" alt="@enrollment.Course.Title" style="height: 200px; object-fit: cover;">
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title">@enrollment.Course.Title</h5>
                                    <p class="card-text text-muted">@enrollment.Course.Instructor?.User?.FullName</p>
                                    <p class="card-text flex-grow-1">@enrollment.Course.Description</p>
                                    
                                    <div class="mt-auto">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <small class="text-muted">Tiến độ</small>
                                            <small class="text-muted">@enrollment.ProgressPercentage%</small>
                                        </div>
                                        <div class="progress mb-3">
                                            <div class="progress-bar @(enrollment.ProgressPercentage == 100 ? "bg-success" : "")" 
                                                 role="progressbar" 
                                                 style="width: @enrollment.ProgressPercentage%" 
                                                 aria-valuenow="@enrollment.ProgressPercentage" 
                                                 aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        
                                        @if (enrollment.CompletedAt != null)
                                        {
                                            <div class="alert alert-success py-2">
                                                <i class="fas fa-check-circle"></i> Hoàn thành ngày @enrollment.CompletedAt?.ToString("dd/MM/yyyy")
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="alert alert-info py-2">
                                                <i class="fas fa-clock"></i> Đăng ký ngày @enrollment.EnrolledAt.ToString("dd/MM/yyyy")
                                            </div>
                                        }
                                        
                                        <div class="d-grid">
                                            <a href="@Url.Action("Details", "Courses", new { id = enrollment.Course.Id })" 
                                               class="btn btn-primary">
                                                @(enrollment.ProgressPercentage > 0 ? "Tiếp tục học" : "Bắt đầu học")
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center py-5">
                    <i class="fas fa-book fa-4x text-muted mb-4"></i>
                    <h3>Chưa có khóa học nào</h3>
                    <p class="text-muted mb-4">Bạn chưa đăng ký khóa học nào. Hãy khám phá các khóa học thú vị để bắt đầu hành trình học tập!</p>
                    <a href="@Url.Action("Index", "Courses")" class="btn btn-primary btn-lg">
                        <i class="fas fa-search"></i> Khám phá khóa học
                    </a>
                </div>
            }
        </main>
    </div>
</div>

<style>
.sidebar {
    min-height: calc(100vh - 56px);
}

.sidebar .nav-link {
    color: #333;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 5px;
}

.sidebar .nav-link:hover,
.sidebar .nav-link.active {
    background-color: #007bff;
    color: white;
}
</style>